; PlatformIO Project Configuration – FaceGuard Pro (ESP32-CAM)
; Board: AI-Thinker ESP32-CAM  |  Framework: Arduino + ESP-IDF

[env:esp32cam]
platform    = espressif32@5.1.0
board       = esp32cam
framework   = arduino, espidf

; ── Partition table ──────────────────────────────────────────────────────────
; Needs more than the default 1.2 MB app space for face recognition libs + HTML
board_build.partitions = partitions/huge_app.csv

; ── Serial monitor ───────────────────────────────────────────────────────────
monitor_speed = 115200
monitor_rts   = 0
monitor_dtr   = 0
monitor_filters = colorize, time

; ── Dependencies ─────────────────────────────────────────────────────────────
lib_deps =
    bblanchon/ArduinoJson @ ^6.21.3
    greiman/SdFat @ ^2.2.3

; ── Build flags ──────────────────────────────────────────────────────────────
build_flags =
    -D BOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    ;
    ; ── SdFat v2 configuration ────────────────────────────────────────────────
    ; SDFAT_FILE_TYPE=3  → compile both FAT16/32 and exFAT; use FsFile / SdFs.
    ;                      This is what gives you full long-filename (LFN) support.
    -D SDFAT_FILE_TYPE=3
    ;
    ; ENABLE_SDIO_CLASS=1 → enable SdioConfig / hardware SDMMC path on ESP32.
    ;                        Required for SdioConfig(FIFO_SDIO) in initSD().
    -D ENABLE_SDIO_CLASS=1
    ;
    ; USE_LONG_FILE_NAMES=255 → allow filenames up to 255 chars on FAT32.
    -D USE_LONG_FILE_NAMES=255
    ;
    ; Uncomment to enable detailed face-recognition logging:
    ; -D CONFIG_ESP_FACE_DETECT_ENABLED=1
    ; -D CONFIG_ESP_FACE_RECOGNITION_ENABLED=1
    ;
    ; Increase HTTP task stack if you see stack overflows in logs:
    ; -D CONFIG_HTTPD_MAX_REQ_HDR_LEN=1024

; ── Source filter ─────────────────────────────────────────────────────────────
; PlatformIO picks up src/*.cpp automatically.

; ── Upload (adjust port as needed) ───────────────────────────────────────────
; upload_port   = COM3
; upload_speed  = 921600
